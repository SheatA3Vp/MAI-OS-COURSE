# Лабораторная работа №2: Многопоточная обработка данных

## Цель работы

Целью является приобретение практических навыков в:
- Управление потоками в ОС
- Обеспечение синхронизации между потоками

## Задание

Составить программу на языке Си, обрабатывающую данные в многопоточном режиме. При обработки использовать стандартные средства создания потоков операционной системы (Windows/Unix). Ограничение максимального количества потоков, работающих в один момент времени, должно быть задано ключом запуска вашей программы. Так же необходимо уметь продемонстрировать количество потоков, используемое вашей программой с помощью стандартных средств операционной системы. В отчете привести исследование зависимости ускорения и эффективности алгоритма от входных данных и количества потоков. Получившиеся результаты необходимо объяснить.

**20 вариант. Дан массив координат (x, y, z). Необходимо найти три точки, которые образуют треугольник максимальной площади**

## Структура проекта

- `main.c` - Основной файл программы с многопоточной реализацией поиска треугольника максимальной площади. Для однопоточной реализации в консоль вводится количество потоков, равное 1.
- `coordinates.h` - Заголовочный файл с объявлениями глобальных переменных для координат.
- `coordinates_data.c` - Файл с данными координат (массив из 10000 точек и количество точек). При необходимости можно заменить на другой массив.
- `generate_coords.py` - Python-скрипт для генерации новых координат (для тестирования работы программы).

## Компиляция

Для компиляции программы используйте GCC с поддержкой POSIX threads:

```bash
gcc -o main main.c coordinates_data.c -lpthread -lm
```

- `-lpthread` - для поддержки POSIX threads
- `-lm` - для математических функций (sqrt)

## Использование

Программа запускается из командной строки с обязательным аргументом - количеством потоков. Опционально можно указать количество точек для обработки (по умолчанию используется все 10000 точек).

### Синтаксис запуска:

```bash
./main <num_threads> [num_points]
```

### Примеры:

1. Запуск с 4 потоками, используя все точки:
   ```bash
   ./main 4
   ```

2. Запуск с 8 потоками, используя только первые 1000 точек:
   ```bash
   ./main 8 1000
   ```

3. Последовательная версия (1 поток):
   ```bash
   ./main 1
   ```

### Вывод программы:

Программа выводит:
- Время выполнения (последовательное или параллельное с указанием количества потоков)
- Максимальную площадь треугольника
- Индексы трех точек, образующих этот треугольник

Пример вывода:
```
Parallel time with 4 threads: 1250 ms
Max area: 2456.78 at points 123, 456, 789
```

### Примечание

Для более быстрой работы программы можете рассмотреть [различные флаги компиляции для оптимизации](https://wiki.gentoo.org/wiki/GCC_optimization/ru). 
Например, можно использовать связку таких флагов, как `-O2 -ffast-math`:

```bash
gcc -O2 -ffast-math -o main main.c coordinates_data.c -lpthread -lm
```

## Генерация новых данных

Если необходимо сгенерировать новый набор координат, используйте Python-скрипт:

```bash
python3 generate_coords.py <num_points>
```

Например, для генерации 100 точек:

```bash
python3 generate_coords.py 100
```

Это обновит файл `coordinates_data.c` с указанным количеством случайных точек в диапазоне от 0 до 100 по каждой координате.

## Демонстрация количества потоков

Для демонстрации количества потоков, используемых программой, можно воспользоваться стандартными средствами операционной системы Linux:

### Использование `ps`:

```bash
ps -T -p $(pgrep main)
```

Или во время выполнения:

```bash
ps -T -C main
```

### Использование `top`:

Запустите `top` в терминале, затем найдите процесс `main` и нажмите `H` для отображения потоков.

### Использование `htop`:

Если установлен `htop`:

```bash
htop -p $(pgrep main)
```

